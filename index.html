
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IA Geradora de Arquivos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="container max-w-2xl mx-auto p-4">
    <h1 class="text-3xl font-bold mb-6 text-center">IA Geradora de Arquivos</h1>

    <div class="bg-white p-6 rounded shadow-md">
      <label class="block mb-2 font-semibold">Tipo de Arquivo:</label>
      <select id="fileType" class="w-full p-2 border rounded mb-4">
        <option value="txt">Texto (.txt)</option>
        <option value="html">HTML (.html)</option>
        <option value="js">JavaScript (.js)</option>
        <option value="py">Python (.py)</option>
        <option value="json">JSON (.json)</option>
      </select>

      <label class="block mb-2 font-semibold">Modelo de IA:</label>
      <select id="modelSelect" class="w-full p-2 border rounded mb-4">
        <option value="Xenova/codegen-350M-mono">Xenova/codegen-350M-mono</option>
        <option value="Xenova/gpt2">Xenova/gpt2</option>
        <option value="Xenova/bert-base-uncased">Xenova/bert-base-uncased</option>
      </select>

      <label class="block mb-2 font-semibold">Descrição do Conteúdo:</label>
      <textarea id="description" rows="5" class="w-full p-2 border rounded mb-4" placeholder="Descreva o que deseja que a IA gere..."></textarea>

      <button onclick="generateFile()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full sm:w-auto">Gerar Arquivo</button>
    </div>

    <div id="resultSection" class="mt-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Conteúdo Gerado:</h2>
      <pre id="fileContent" class="bg-gray-200 p-4 rounded overflow-auto whitespace-pre-wrap"></pre>
      <div class="flex flex-col sm:flex-row gap-2 mt-4">
        <button onclick="downloadFile()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Baixar Arquivo</button>
        <button onclick="showHistory()" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700">Ver Histórico</button>
      </div>
    </div>

    <div id="historySection" class="mt-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Histórico:</h2>
      <ul id="historyList" class="space-y-2"></ul>
    </div>
  </div>

  <script>
    async function generateFile() {
      const type = document.getElementById('fileType').value;
      const description = document.getElementById('description').value.trim();
      const modelName = document.getElementById('modelSelect').value;
      const resultSection = document.getElementById('resultSection');
      const fileContent = document.getElementById('fileContent');

      if (!description) {
        alert('Por favor, insira uma descrição.');
        return;
      }

      fileContent.textContent = 'Gerando conteúdo com IA usando ' + modelName + '...';

      const generator = await window.Transformers.pipeline('text-generation', modelName);
      const output = await generator(description, { max_new_tokens: 200 });
      const generatedText = output[0].generated_text;

      fileContent.textContent = generatedText;
      resultSection.classList.remove('hidden');

      saveToHistory(type, description, generatedText);
    }

    function downloadFile() {
      const type = document.getElementById('fileType').value;
      const content = document.getElementById('fileContent').textContent;
      const blob = new Blob([content], { type: 'text/plain' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `arquivo-gerado.${type}`;
      link.click();
    }

    function saveToHistory(type, description, content) {
      const history = JSON.parse(localStorage.getItem('fileHistory') || '[]');
      history.push({ type, description, content, date: new Date().toISOString() });
      localStorage.setItem('fileHistory', JSON.stringify(history));
    }

    function showHistory() {
      const historySection = document.getElementById('historySection');
      const historyList = document.getElementById('historyList');
      const history = JSON.parse(localStorage.getItem('fileHistory') || '[]');

      historyList.innerHTML = '';
      history.forEach((item) => {
        const li = document.createElement('li');
        li.className = 'bg-white p-4 rounded shadow';
        li.innerHTML = `<strong>${item.type}</strong> - ${new Date(item.date).toLocaleString()}<br>
                        <em>${item.description}</em><pre class="mt-2 bg-gray-100 p-2 rounded whitespace-pre-wrap">${item.content}</pre>`;
        historyList.appendChild(li);
      });

      historySection.classList.remove('hidden');
    }
  </script>
</body>
</html>
